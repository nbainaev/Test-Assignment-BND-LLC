# People Detection with YOLOv8

## Описание проекта

Решение тестового задания на вакансию Data Scientist в BND LLC. Проект реализует детекцию людей на видео с использованием модели  YOLOv8. Основные возможности:

- Обнаружение людей в видео потоке
- Гибкая настройка параметров детекции (пороги уверенности (confidence), IoU)
- Визуализация результатов с настраиваемыми bounding boxes
- Сохранение обработанного видео с результатами детекции

## Особенности реализации

- Конфигурация через YAML-файл для удобного управления параметрами
- Логирование процесса обработки

## Требования

- Python 3.8+
## Установка и запуск

1. Клонируйте репозиторий:
```bash
git clone https://github.com/nbainaev/Technical-Assignment-BND-LLC.git
cd Technical-Assignment-BND-LLC
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Запустите программу:
```bash
python ./scripts/main.py
```

## Конфигурация

Параметры работы программы настраиваются через файл `configs/config.yaml`:

```yaml
# Оновные параметры
model: "yolov8m.pt" # Тип модели
iou: 0.7 # Пороговое значение метрики IoU для учета предсказания модели
conf: 0.5 # Порог степени уверенности модели в предсказании для отнесения к предсказываемому классу
video_path: "../data/crowd.mp4" # Путь к видео для обработки
save_path: "../output/detected_video.mp4" # Путь для сохранения обработанного видео
weights_path: "../weigths/yolov8s.pt" # Путь к весам модели

# Параметры отображения а видео
line_width: 2 # Ширина линии bounfing box
font_size: 0.8 # Размер шрифта для отображения названия класса
labels: True # Флаг для отображения названий классов на видео
boxes: True # Флаг для отображния bounding box на видео
```


## Структура проекта

```
Test-Assignment-BND-LLC/
├── configs/               # Конфигурационные файлы
│   └── config.yaml
├── data/                  # Входные данные
├── output/                # Результат работы
├── scripts/               # Основной код
│   ├── main.py            # Точка входа
│   ├── video_processing.py # Обработка видео
│   └── utils.py           # Вспомогательные функции
└── requirements.txt       # Зависимости
```

## Выводы

На основе видео, обработанного с помощью модель YOLOv8-m, можно сделать следующие выводы:
- Модель плохо детектирует небольшие или частично закрытые объекты (люди вдалеке, в толпе)
- Модель иногда ошибается (на нескольких кадрах неверно опознан один объект)
- Модель в целом достаточно хорошо опознает объекты на переднем плане кадра (нет упущенных объектов)
- Время обработки видео: ~ 4 мин.

## Рекомендации по улучшению

Для данной реализации можно дать следующие рекомендации по улучшению:
1. Оптимизация скорости работы модели:
	- Батч-обработка кадров, использование GPU: использовать батч-обработку кадров видео (например, сбор N последовательных кадров, потом подача на вход нейросети) и использование параллельных вычислений на GPU с помощью CUDA позволит в 2-3 раза уменьшить время обработки видео.
	- Использование более простой модели: В линейке моделей YOLOv8 доступны более простые модели YOLOv8-s и YOLOv8-n, которые показывают более высокую скорость обработки кадров, хотя и с меньшим качеством детекции.
	- Изменение разрешения кадров перед подачей в нейронную сеть: Приведет к увеличению скорости обработки, но также может пострадать точность детекции.
2. Для улучшения качества детекции можно:
	- Понизить IoU: Понижение IoU даст повышение количества детектированных объектов и увеличение recall, но может привести к уменьшению меткости (precision). Для задачи обнаружения людей вполне подходит значение IoU 0.5-0.6, если нужно выделять мелкие объекты, то стоит уменьшить (например, до 0.3-0.4)
	- Использование более сложной модели: В линейке моделей YOLOv8 доступны также более сложные YOLOv8-l. и YOLOv8-x, которые показывают лучшие метрики детекции по сравению с моделью YOLOv8-m. 
	- Для борьбы с ложной детекцией можно повысить пороговое значение confidence (напрмер, до 0.7-0.8), тогда модель будет более избирательна. В приложенном видео значение confidence для артефакта составляло не больше 0.7, повышение уровня confidence привело бы к его устранению. Но при этом могут быть откинуты и объекты детектируемого класса.